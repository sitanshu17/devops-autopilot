# DevOps Autopilot

An intelligent DevOps automation tool that generates Terraform infrastructure code using multiple AI providers. Built with Go for high performance and reliability.

## ğŸš€ Features

- **Dual AI Providers**: Choose between OpenAI GPT and GitHub Copilot for code generation
- **Cost-Effective Options**: Free GitHub Models API alongside premium OpenAI
- **Terraform Validation**: Built-in validation using local Terraform CLI
- **RESTful API**: Clean HTTP endpoints for integration with other tools
- **Smart File Management**: Automatically saves generated code with provider prefixes
- **A/B Testing**: Compare code quality between different AI providers
- **Robust Error Handling**: Comprehensive error handling and validation
- **High Performance**: Built with Go for speed and efficiency

## ğŸ“‹ Prerequisites

1. **Go 1.18 or higher** - [Download Go](https://golang.org/dl/)
2. **Terraform CLI** - [Download Terraform](https://developer.hashicorp.com/terraform/downloads) (for validation)
3. **AI Provider Keys** (choose one or both):
   - **OpenAI API Key** - [Get from OpenAI Platform](https://platform.openai.com/api-keys)
   - **GitHub Personal Access Token** - [Generate from GitHub Settings](https://github.com/settings/tokens)

## ğŸ› ï¸ Setup

1. **Clone the repository:**
   ```bash
   git clone https://github.com/yourusername/devops-autopilot.git
   cd devops-autopilot
   ```

2. **Create a `.env` file with your API keys:**
   ```env
   # Required for OpenAI endpoint
   OPENAI_API_KEY=your_openai_api_key_here
   
   # Required for GitHub Copilot endpoint  
   GITHUB_TOKEN=your_github_personal_access_token_here
   
   # Optional
   PORT=5000
   ```
   
   **Note**: You can use either one or both API keys depending on which endpoints you want to use.

3. **Install Go dependencies:**
   ```bash
   go mod tidy
   ```

## ğŸƒâ€â™‚ï¸ Running the Application

### Option 1: Run directly
```bash
go run main.go
```

### Option 2: Build and run
```bash
go build -o devops-autopilot
./devops-autopilot
```

The server will start on `http://localhost:5000`

## ğŸ“¡ API Endpoints

### Health Check
```http
GET http://localhost:5000/api/provision/health
```

**Response:**
```json
{
  "status": "Service is healthy"
}
```

### Generate Terraform Code (OpenAI)
```http
POST http://localhost:5000/api/provision/terraform
Content-Type: application/json

{
  "resource": "EC2 instance",
  "specs": "t3.micro instance in us-east-1 with Ubuntu 20.04"
}
```

### Generate Terraform Code (GitHub Copilot)
```http
POST http://localhost:5000/api/provision/terraform-copilot
Content-Type: application/json

{
  "resource": "EC2 instance", 
  "specs": "t3.micro instance in us-east-1 with Ubuntu 20.04"
}
```

**Response (both endpoints):**
```json
{
  "message": "Terraform code generated successfully",
  "terraformCode": "resource \"aws_instance\" \"example\" {\n  ami = \"ami-0c55b159cbfafe1d0\"\n  instance_type = \"t3.micro\"\n}",
  "validation": {
    "isValid": true,
    "errors": [],
    "warnings": [],
    "execTime": 1250
  }
}
```

### Validate Terraform Code
```http
POST http://localhost:5000/api/provision/validate
Content-Type: application/json

{
  "terraformCode": "resource \"aws_instance\" \"example\" {\n  ami = \"ami-0c55b159cbfafe1d0\"\n  instance_type = \"t3.micro\"\n}"
}
```

## ğŸ“ Project Structure

```
devops-autopilot/
â”œâ”€â”€ main.go                    # Application entry point
â”œâ”€â”€ go.mod                     # Go module definition
â”œâ”€â”€ go.sum                     # Go dependencies checksum
â”œâ”€â”€ handlers/
â”‚   â””â”€â”€ provision.go           # HTTP handlers (REST controllers)
â”œâ”€â”€ services/
â”‚   â””â”€â”€ terraform_service.go   # Business logic layer
â”œâ”€â”€ models/
â”‚   â””â”€â”€ requests.go           # Data models and DTOs
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ provision.go          # API routing configuration
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ openai.go            # OpenAI API integration
â”‚   â”œâ”€â”€ github.go            # GitHub Models API integration
â”‚   â””â”€â”€ terraform.go         # Terraform CLI validation
â”œâ”€â”€ tf-generated-files/       # Generated Terraform files
â”‚   â”œâ”€â”€ openai_*.tf          # Files generated by OpenAI
â”‚   â””â”€â”€ copilot_*.tf         # Files generated by GitHub Copilot
â”œâ”€â”€ .env                     # Environment variables (not committed)
â”œâ”€â”€ .gitignore               # Git ignore rules
â””â”€â”€ README.md                # This file
```

## ğŸ”§ Configuration

Create a `.env` file in the project root:

```env
# OpenAI Configuration (required for /terraform endpoint)
OPENAI_API_KEY=sk-your-openai-api-key-here

# GitHub Configuration (required for /terraform-copilot endpoint)
GITHUB_TOKEN=ghp_your-github-personal-access-token-here

# Server Configuration (optional, defaults shown)
PORT=5000
```

### API Provider Comparison

| Feature | OpenAI API | GitHub Models API |
|---------|------------|-------------------|
| **Cost** | Pay-per-use | Free tier available |
| **Models** | GPT-3.5, GPT-4 | GPT-4o, GPT-4o-mini, Claude |
| **Quality** | Excellent | Excellent (code-optimized) |
| **Rate Limits** | Based on plan | Generous free limits |
| **Setup** | OpenAI API Key | GitHub Personal Access Token |

## ğŸ¯ File Management

Generated Terraform files are automatically saved in `tf-generated-files/` with provider prefixes:

- **OpenAI**: `openai_ec2_instance_1.tf`
- **GitHub Copilot**: `copilot_ec2_instance_1.tf`

This makes it easy to:
- Compare outputs from different providers
- Track which AI generated which code
- Organize files by AI provider

## ğŸš€ Building for Production

```bash
# Build for current platform
go build -o devops-autopilot

# Cross-platform builds
GOOS=windows GOARCH=amd64 go build -o devops-autopilot.exe
GOOS=linux GOARCH=amd64 go build -o devops-autopilot
GOOS=darwin GOARCH=amd64 go build -o devops-autopilot
```

## ğŸ¤ Contributing

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## ğŸ“ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## âš ï¸ Security Note

Never commit your `.env` file or expose your API keys. The `.gitignore` file is configured to exclude sensitive files.

## ğŸ¤– AI Provider Setup

### OpenAI Setup
1. Visit [OpenAI Platform](https://platform.openai.com/api-keys)
2. Create a new API key
3. Add it to your `.env` file as `OPENAI_API_KEY`

### GitHub Models Setup  
1. Visit [GitHub Settings](https://github.com/settings/tokens)
2. Generate a new Personal Access Token (classic)
3. Select scopes: `repo`, `user`, `read:org`
4. Add it to your `.env` file as `GITHUB_TOKEN`

## ğŸ§ª Testing Both Providers

You can easily A/B test both providers:

```bash
# Test OpenAI
curl -X POST http://localhost:5000/api/provision/terraform \
  -H "Content-Type: application/json" \
  -d '{"resource": "S3 bucket", "specs": "with versioning enabled"}'

# Test GitHub Copilot  
curl -X POST http://localhost:5000/api/provision/terraform-copilot \
  -H "Content-Type: application/json" \
  -d '{"resource": "S3 bucket", "specs": "with versioning enabled"}'
```
